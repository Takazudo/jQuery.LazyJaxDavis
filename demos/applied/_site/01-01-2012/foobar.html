<!doctype html>
<html class="no-js" lang="ja">
<head>
<meta charset="utf-8">
<title>jQuery.LazyJaxDavis - Davis.js</title>
<meta name="viewport" content="width=1000">
<link rel="stylesheet" href="/jQuery.LazyJaxDavis/demos/applied/common/css/style.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script src="/jQuery.LazyJaxDavis/lib/davis.js"></script>
<script src="/jQuery.LazyJaxDavis/jquery.lazyjaxdavis.js"></script>
<script src="/jQuery.LazyJaxDavis/demos/applied/common/js/script.js"></script>
</head>
<body><div class="mod-all">

<div class="mod-header">
	<h1><a href="/jQuery.LazyJaxDavis/demos/applied/_site/">jQuery.LazyJaxDavis</a></h1>
</div>


<div class="mod-body">
	<div class="mod-side">
	<ul class="mod-sidenav" id="sidenav">
		<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/">Introduction</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-01-2012/foobar.html">Davis.js</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-02-2012/quickbrown.html">setup</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-03-2012/jumpsover.html">URL routing</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-04-2012/theLazyDog.html">Davis.js routing</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-05-2012/foobar.html">Davis.js routing</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-06-2012/anchorhandling.html">Anchor handling</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-07-2012/jumpsover.html">Lazy links</a></li>
		
			<li><a href="/jQuery.LazyJaxDavis/demos/applied/_site/01-08-2012/theLazyDog.html">Lazy Forms</a></li>
		
	</ul>
</div>

	<div class="mod-main" id="main">
			<div id="lazyjaxdavisroot">
			<!-- LazyJaxDavis start -->

			<div class="mod-article">
				<h2>Davis.js</h2>

<p>jQuery.LazyJaxDavis needs <a href="http://davisjs.com/">Davis.js</a> to work.<br/>
If you want to use jQuery.LazyJaxDavis, you need to load Davis.js too.</p>

<h3>What is Davis.js?</h3>

<p><a href="http://davisjs.com/">Davis.js</a>'s website says</p>

<blockquote><p>Davis.js is a small JavaScript library using HTML5 history.pushState that allows simple Sinatra style routing for your JavaScript apps.</p></blockquote>

<p>Generally, Davis.js was made for the web apps using history API. With this library, you can make url routings for web apps easily. <a href="http://documentcloud.github.com/backbone/">Backbone.js</a>'s Router provides similar API.</p>

<h3>How to use Davis.js</h3>

<p>With Davis.js, you can create url routings like below.</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>

  <span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Davis</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
      <span class="c1">// do something when url was changed to &#39;/&#39;</span>
    <span class="p">})</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/user/:name&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// do something when url was changed to &#39;/user/*&#39;</span>
      <span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">params</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">];</span> <span class="c1">// you can get the value of &#39;:name&#39; in url</span>
    <span class="p">})</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/help&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// do something when url was changed to &#39;/help&#39;</span>
    <span class="p">})</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/update&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
      <span class="c1">// do something when url was changed to &#39;/update&#39;</span>
    <span class="p">})</span>
  <span class="p">})</span>
  <span class="nx">app</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s1">&#39;routeNotFound&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">req</span><span class="p">){</span>
    <span class="c1">// if the url was not routed, this event handler will be fired.</span>
    <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;this url was not routed!&#39;</span><span class="p">);</span>
  <span class="p">});</span>

<span class="p">});</span>
</code></pre>
</div>


<p>This helps you to create url based JavaScript based web apps.<br/>
Learn more about Davis.js on the <a href="http://davisjs.com/">Davis.js's website</a>.</p>

<h3>Davis'js and jQuery.LazyJaxDavis</h3>

<p>jQuery.LazyJaxDavis uses Davis.js in it.<br/>
In web apps, you almost need to assign what to do to urls. For example, if the url was '/help', show help page - or - if the url was '/user/foobar', show the page of the user 'foobar' - or something like that.</p>

<p>This is very useful to develop web apps. But, imagine that you create your own blog. It is ok if you have a few posts on it. But, generally you will have many many posts on your blog. So it is almost impossible to handle all urls of the pages you created.</p>

<p>So, I focused on the <code>routeNotFound</code> event of Davis.js. This event is fired when the requested page was not routed. jQuery.LazyJaxDavis does ajax to the requested page even if it was unrouted. Then you can handle the ajax events like below.</p>

<div class="highlight"><pre><code class="javascript"><span class="nx">$</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>

  <span class="nx">$</span><span class="p">.</span><span class="nx">LazyJaxDavis</span><span class="p">({</span>
    <span class="nx">everyfetchstart</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">page</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// When the url was changed, this fetches the page</span>
      <span class="c1">// before ajax was started, you can do something here.</span>

    <span class="p">},</span>
    <span class="nx">everyfetchsuccess</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">page</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// When ajax was done, you can do something here</span>

      <span class="kd">var</span> <span class="nx">ripped</span> <span class="o">=</span> <span class="nx">page</span><span class="p">.</span><span class="nx">rip</span><span class="p">(</span><span class="s1">&#39;content&#39;</span><span class="p">);</span> <span class="c1">// you can rip the html source of fetched page</span>
      <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#somewhere&#39;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">ripped</span><span class="p">);</span> <span class="c1">// then update the page with it</span>

    <span class="p">}</span>
  <span class="p">});</span>

<span class="p">});</span>
</code></pre>
</div>


<p>The main design pattern of jQuery.LazyJaxDavis is - fetch the part of the page - then refresh somewhere on the page. jQuery.LazyJaxDavis provides some APIs to do this easily.</p>

<p>The main part of jQuery.LazyJaxDavis is the events above - <code>everyfetchstart</code> and <code>everyfetchsuccess</code>. These are mostly for unrouted urls. This is why I call this script "lazy".</p>

<p>But, jQuery.LazyJaxDavis also provides url routing features too.<br/>
Keep reaing to learn more about those.</p>

			</div>

			<!-- LazyJaxDavis end -->
			</div>
	</div>
</div>

<div class="mod-footer">
	This page is the demo of <a href="https://github.com/Takazudo/jQuery.LazyJaxDavis">jQuery.LazyJaxDavis</a>.
</div>


</div></body>
</html>
